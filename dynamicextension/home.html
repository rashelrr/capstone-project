<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Guide to Developing Accessible Dynamic Content for Screen Reader Users</title>
  <link rel="stylesheet" href="css/reader.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="scripts/reader.js"></script>
</head>
<body>
<div class="offscreen">Main Content</div>
<div class="container">
<!-- <div class="navigation">
  <a href="#home"><img src="pics/home.png"></a><a href="#links"><img src="pics/links.png"></a> <a href="#signup"><img src="pics/signup.png"></a>
</div> -->

<h1>Guide to Developing Accessible Dynamic Content for Screen Reader Users</h1>
<!-- <div id="accessibilitybanner"></div> -->

<!-- LEVEL 1: ERROR MESSAGES -->

<h2>Provide error messages and notifications accessibly.</h2>
<p>Ensure that your error messages and notification messages are not only merely able to be read by the screen reader,
  but they also inform the user in a timely manner while allowing them to handle the situation at their own pace.</p>
  
<hr>

<h3>What Not to Do: Error Messages</h3>
<p>Example 1A: Use a screen reader extension. Try putting in a non-email address and submit.</p>
  <!-- Code from: https://developer.mozilla.org/en-US/docs/Learn/Forms/Form_validation -->
<form>
  <label for="mail1">
    I would like you to provide me with an email address:
  </label>
  <input type="email" id="mail1" name="mail1" />
  <button>Submit</button>
</form>
<p>The above error message is NOT accessible to screen reader users. You may have noticed when an invalid email address
  is entered, the error message is not relayed to the user at all. Instead, the user is simply redirected back to the
  input box, which can confuse users. Users are not made aware that this was due to an invalid email address, and they
  could misinterpret this redirection as a technical glitch.</p>
<h3>What to Do Instead: Error Messages</h3>
<p>Example 1B: Try the same thing on this example.</p>
<form>
  <label for="mail2">
    I would like you to provide me with an email address:
  </label>
  <input type="email" id="mail2" name="mail2" required aria-describedby="errmsg" aria-invalid="false"/>
  <span aria-live="polite" id="errmsg" hidden>Please enter a valid email address.</span>
  <button>Submit</button>
</form>
<p>Notice how this time, the screen reader read aloud the error message, thus making it accessible to screen reader users.
  Let's take a look at the code for each of these examples.</p>
<h3>Code and Best Practices: Error Messages</h3>

<p>1. Use <b>aria-describedby</b> to associate the error message with the input.</p>
<p>2. Set <b>aria-invalid</b> to true when the input is invalid. This will be conveyed to the user through the screen reader.
  This was implemented through Javascript in Example 1B.</p>
<p>3. Use <b>aria-live</b> to convey error messages that do not take focus. This will ensure that the error message is read by
  the screen reader.</p>
<p><i>As you can see, a few simple changes can make your error messages available to a greater number of users!</i></p>

<p>HTML:</p>
<div class="codeleft">
  <pre>
    <code>
      &lt;!-- // EXAMPLE 1A -->
      &lt;form>
        &lt;label for="mail1">
          I would like you to provide me with an email address:
        &lt;/label>
        &lt;input type="email" id="mail1" name="mail1" />
        &lt;button>Submit&lt;/button>
      &lt;/form>

    </code>
  </pre>
</div>

<div class="coderight">
  <pre>
    <code>
      &lt;!-- // EXAMPLE 1B -->
      &lt;form>
        &lt;label for="mail2">
          I would like you to provide me with an email address:
        &lt;/label>
        &lt;input type="email" id="mail2" name="mail2" required aria-describedby="errmsg" aria-invalid="false"/>
        &lt;span aria-live="polite" id="errmsg" hidden>Please enter a valid email address.</span>
        &lt;button>Submit</button>
      &lt;/form>
    </code>
  </pre>
</div>

<br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> 
<p>Javascript:</p>
<div class="codeleft">
  <pre>
    <code>
      // EXAMPLE 1A
      const email1 = document.getElementById("mail1");
  
      email1.addEventListener("input", (event) => {
        if (email1.validity.typeMismatch) {
          email1.setCustomValidity("Please enter a valid email address.");
        } else {
          email1.setCustomValidity("");
        }
      });
    </code>
  </pre>
</div>

<div class="coderight">
  <pre>
    <code>
      // EXAMPLE 1B
      const email2 = document.getElementById("mail2");

      email2.addEventListener("input", (event) => {
        if (email2.validity.typeMismatch) {
          email2.setAttribute("aria-invalid", "true");
        } else {
          email2.setAttribute("aria-invalid", "false")
        }
      });
    </code>
  </pre>
</div>

<br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br>
<hr>
<h3>What Not to Do: Notifications</h3>
<p>Example 2A: To be implemented in the future...</p>
<h3>What to Do Instead: Notifications</h3>
<p>Example 2B: To be implemented in the future...</p>

<hr>

<!-- LEVEL 2: HOVER CONTENT -->

<h2>Make content that appears on hover or focus accessible.</h2>
<p>Content that appears on hover or focus should remain visible to the user until they are
  done reading the content. Therefore, content should remain visible until dismissed by the user
  without moving the pointer of changing the keyboard focus. The Escape key is the best way to do this.
</p>

<hr>

<h3>What Not to Do: Hover Content</h3>
<p>Example 1A: Hover over the link below. </p>
Hover over <a href="https://www.google.com/" class="bad-hover-link">link</a>
<div class="bad-hover-context">Clicking the link will open Google.</div>
<p>The new content disappears immediately after the user moves the pointer
  away from the link. It also is not dismissable via the Escape key. Thus,
  it is not accessible.
</p>

<h3>What to Do Instead: Hover Content</h3>
<p>Example 1B: Try the same thing on this example.</p>
<!--Code Source: https://www.w3.org/WAI/WCAG21/Techniques/client-side-script/SCR39-->
<p>Hover over this 
  <a class="a-and-tooltip" id="parent" 
    href="https://www.google.com/">link
    <span id="popup" role="tooltip">Clicking the link will open Google.
    </span>
  </a>
</p>
<p>Notice that the new content is dismissable via the Escape key and it stays
  visible despite moving the pointer.
</p>

<h3>Code and Best Practices: Hover Content</h3>
<ol>
  <li>Use <b>onmouseover</b> to show new content. Don't use <b>onmouseout</b>: 
    this will ensure content stays visible even if pointer is moved.</li>
  <li>Use an event listener for when the Escape key is pressed. </li>
  <li>In the event listener, make the new content disappear when the Escape key is pressed.</li>
</ol> 

<p>HTML:</p>
<div class="codeleft">
  <pre>
    <code>
      &lt;!-- // EXAMPLE 1A -->
      Hover over &lt;a href="https://www.google.com/" class="bad-hover-link">link&lt;/a>
      &lt;div class="bad-hover-context">Clicking the link will open Google.&lt;/div>
    </code>
  </pre>
</div>

<div class="coderight">
  <pre>
    <code>
      &lt;!-- // EXAMPLE 1B -->
      &lt;p>Hover over this 
        &lt;a class="a-and-tooltip" id="parent" 
          href="https://www.google.com/">link
          &lt;span id="popup" role="tooltip">Clicking the link will open Google.
          &lt;/span>
        &lt;/a>
      &lt;/p>
    </code>
  </pre>
</div>

<br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> 

<p>JavaScript:</p>
<div class="codeleft">
  <pre>
    <code> // None
    </code>
  </pre>
</div>

<div class="coderight">
  <pre>
    <code>
      var parent = document.getElementById('parent');

      parent.onmouseover = function() {
          document.getElementById('popup').style.display = 'block';
      }

      document.addEventListener('keydown', (e) => {
        if (e.code == 'Escape')
            document.getElementById('popup').style.display = 'none';
      });
    </code>
  </pre>
</div>

<br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> 

<p>CSS:</p>
<div class="codeleft">
  <pre>
    <code>
      .bad-hover-context {
        display: none;
      }
      
      .bad-hover-link:hover + .bad-hover-context {
        display: block;
        padding: 0.5em;
        background:white;
        color: black;
        border:solid black 2px;
        width:10em;
        top:1em;  
      }
    </code>
  </pre>
</div>

<div class="coderight">
  <pre>
    <code>
      [role="tooltip"] {
        display: none;
        padding: 0.5em;
        background:white;
        color: black;
        border:solid black 2px;
        width:10em;
      }
      
      .a-and-tooltip {
        position: relative;
      }
      
      [role="tooltip"] {
          position: absolute;
          left:0;
          top:1em;
      }
    </code>
  </pre>
</div>

<br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br>
<br> <br> <br> <br> <br> <br> 

<hr>

</div><!-- end div.container -->
</body>
</html>